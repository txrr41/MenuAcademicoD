unit uEstudante;

interface

uses System.Generics.Collections, uDB;

Type
  TEstudante = class(TObject)
  public
     procedure DeletarEstudante;
     procedure ListarEstudante;
     procedure AdicionarEstudante;
    constructor Create(aNome: String; aCodigo: Integer);
    function GetNome: String;
    procedure SetNome(aNome: String);
    function GetCodigo: Integer;
    procedure SetCodigo(aCodigo: Integer);
  private
    nome: String;
    codigo: Integer;

  end;

implementation

procedure TEstudante.AdicionarEstudante(Estudante: TEstudante);
begin

end;

constructor TEstudante.Create(aNome: String; aCodigo: Integer);
begin
  Self.nome := aNome;
  Self.codigo := aCodigo;
end;

procedure TEstudante.DeletarEstudante;
  var
  idStr: string;
  idEstudante: Integer;
  confirmacao: Integer;
begin
  if Form2.ListBoxEstudantes.ItemIndex = -1 then
  begin
    ShowMessage('Selecione um estudante para deletar.');
    Exit;
  end;


  idStr := ListBoxEstudantes.Items[ListBoxEstudantes.ItemIndex];
  idEstudante := StrToInt(Copy(idStr, 1, Pos(' -', idStr) - 1));

  confirmacao := MessageDlg('Deseja realmente excluir este estudante?', mtConfirmation, [mbYes, mbNo], 0);
  if confirmacao = mrYes then
  begin
    DataModule1.FDQueryEstudante.SQL.Text := 'UPDATE estudantes SET ativo = false WHERE id = :id';
    DataModule1.FDQueryEstudante.ParamByName('id').AsInteger := idEstudante;
    DataModule1.FDQueryEstudante.ExecSQL;

    ShowMessage('Estudante deletado com sucesso!');

    ListarClick(nil); // Recarrega a listagem
  end;
end;

procedure TForm2.ListarClick(Sender: TObject);
var
estudante: TEstudante;
begin
   ListarEstudante(Estudante);
  end;

function TEstudante.GetCodigo: Integer;
begin
  result := Self.codigo;
end;

function TEstudante.GetNome: String;
begin
  result := Self.nome;
end;

procedure TEstudante.ListarEstudante(Estudante: TEstudante);
begin

end;

procedure TEstudante.SetCodigo(aCodigo: Integer);
begin
  Self.codigo := aCodigo;
end;

procedure TEstudante.SetNome(aNome: String);
begin
  Self.nome := aNome;
end;

end.
